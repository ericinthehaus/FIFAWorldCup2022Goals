text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All teams",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(treemapify)
library(shiny)
library(tidyr)
raw_data <- read.csv("WCGoalsData.csv")
# source = "https://fbref.com/en/comps/1/shooting/World-Cup-Stats"
goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All teams, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt
View(goal_scorers)
View(teams_list)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(treemapify)
library(shiny)
library(tidyr)
raw_data <- read.csv("WCGoalsData.csv")
# source = "https://fbref.com/en/comps/1/shooting/World-Cup-Stats"
teams_list <- goal_scorers %>%
select(Squad, Gls) %>%
slice(12) %>%
unique()
teams_list <- goal_scorers %>%
select(Squad, Gls) %>%
slice_head(12) %>%
unique()
teams_list <- goal_scorers %>%
select(Squad, Gls) %>%
slice_head(n=12) %>%
unique()
teams_list <- goal_scorers %>%
slice_head(n=12) %>%
select(Squad) %>%
unique()
x=1
y=teams_list
for (x in y ) {
print ( make_goal_treemap(num = x)+theme(plot.caption = element_blank()) )
}
y=teams_list$Squad
for (x in y ) {
print ( make_goal_treemap(num = x)+theme(plot.caption = element_blank()) )
}
y= length( teams_list$Squad )
for (x in y ) {
print ( make_goal_treemap(num = x)+theme(plot.caption = element_blank()) )
}
length(teams_list)
length(teams_list$Squad)
x=1
y= teams_list$Squad
for (x in 1:y ) {
print ( make_goal_treemap(num = x)+theme(plot.caption = element_blank()) )
}
z = 1:y
make_goal_treemap <- function( name= "France") {
# team <- teams_list$Squad[num]
goal_scorers %>%
filter(Squad== team) %>%
ggplot(mapping=  aes(area= Gls, fill= reorder(Player, Gls, sum), label= Player )  ) +
geom_treemap() +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = team,
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
}
for (x in y ) {
print ( make_goal_treemap(num = x)+theme(plot.caption = element_blank()) )
}
y= teams_list$Squad
for (x in y ) {
print ( make_goal_treemap(num = x)+theme(plot.caption = element_blank()) )
}
make_goal_treemap <- function( name= "France") {
# team <- teams_list$Squad[num]
goal_scorers %>%
filter(Squad== team) %>%
ggplot(mapping=  aes(area= Gls, fill= reorder(Player, Gls, sum), label= Player )  ) +
geom_treemap() +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = team,
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
}
y= teams_list$Squad
for (x in y ) {
print ( make_goal_treemap(num = x)+theme(plot.caption = element_blank()) )
}
print ( make_goal_treemap(name = x)+theme(plot.caption = element_blank()) )
for (x in y ) {
print ( make_goal_treemap(name = x)+theme(plot.caption = element_blank()) )
}
y[1]
y[1]
y[1,]
make_goal_treemap <- function( name= "France") {
# team <- teams_list$Squad[num]
goal_scorers %>%
filter(Squad== name) %>%
ggplot(mapping=  aes(area= Gls, fill= reorder(Player, Gls, sum), label= Player )  ) +
geom_treemap() +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = name,
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
}
y= teams_list$Squad
for (x in y ) {
print ( make_goal_treemap(name = x)+theme(plot.caption = element_blank()) )
}
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(treemapify)
library(shiny)
library(tidyr)
raw_data <- read.csv("WCGoalsData.csv")
# source = "https://fbref.com/en/comps/1/shooting/World-Cup-Stats"
goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
save(all_plt, "All goals WC22.png")
save(all_plt, file="All goals WC22.png")
goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(treemapify)
library(shiny)
library(tidyr)
raw_data <- read.csv("WCGoalsData.csv")
# source = "https://fbref.com/en/comps/1/shooting/World-Cup-Stats"
goal_scorers <- raw_data %>%
filter(Gls>0) %>%
select(
Player, Squad, Gls
) %>%
separate_wider_delim(Squad, delim=" ", names=c(NA, "Squad"), too_many = "merge" )
teams_list <- goal_scorers %>%
slice_head(n=12) %>%
select(Squad) %>%
unique()
make_goal_treemap <- function( name= "France") {
# team <- teams_list$Squad[num]
goal_scorers %>%
filter(Squad== name) %>%
ggplot(mapping=  aes(area= Gls, fill= reorder(Player, Gls, sum), label= Player )  ) +
geom_treemap() +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = name,
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
}
x=1
y= teams_list$Squad
for (x in y ) {
print ( make_goal_treemap(name = x)+theme(plot.caption = element_blank()) )
}
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt
save(all_plt, file="All goals WC22.png", )
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png")
warnings()
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Chart created by Eric Hausken * Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt
all_plt <- goal_scorers %>%
ggplot(mapping=  aes(area= Gls,
fill= Squad,
label= Player,
subgroup= reorder(Squad,Gls, max)
)  ) +
geom_treemap(color="gray0") +
theme(
text = element_text(color= "gray90"),
plot.background = element_rect(fill = "gray0"),
plot.title = element_text(color= "gray90", size=18),
legend.position = "none"
) +
labs(
title  = "All goals, grouped by team",
#    subtitle =
fill = "Player",
caption = "Chart created by Eric Hausken | Data from FBRef.com"
) +
geom_treemap_text(fontface = "italic", colour = "white",
place = "bottom", grow = TRUE, reflow = TRUE)
all_plt
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png")
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png", width = 10)
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png", height = 10)
all_plt
all_plt
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png",
height = 640,
width = 480,
units = "px")
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png",
height = 1280,
width = 640,
units = "px")
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png",
height = 1280,
width = 900,
units = "px")
# save(all_plt, file="All goals WC22.png", )
ggsave("All goals WC22.png",
height = 1280,
width = 1280,
units = "px")
ggsave("All goals WC22.jpg",
height = 1280,
width = 1280,
units = "px")
